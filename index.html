<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SUTOM </title>
    <style>
        /* CSS bas√© sur votre design (Bleu fonc√©/Bleu, Rouge/Orange) */
        :root {
            /* Utilisation d'unit√©s VW pour l'adaptabilit√© */
            --taille-grille-max: 90vw;
            --taille-case: 10vw; /* Base de 10% de la largeur de l'√©cran */
            --longueur-mot: 8; 
            --max-tentatives: 6;

            --couleur-fond: #212121;
            --couleur-grille: #1a73e8;
            --couleur-texte: #f0f0f0;
            --couleur-correct: #6aaa64;
            --couleur-misplaced: #ff9900;
            --couleur-absent: #cc0000;
            --couleur-clavier-default: #444;
        }

        body {
            font-family: Arial, sans-serif;
            background-color: var(--couleur-fond);
            color: var(--couleur-texte);
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 10px 0;
            margin: 0;
        }

        /* --- En-t√™te et Messages --- */
        header {
            width: 95%;
            max-width: 500px; /* Limite pour les grands √©crans */
            text-align: center;
            margin-bottom: 20px;
        }
        #message-area {
            min-height: 20px;
            margin-bottom: 10px;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }
        
        /* --- Le Carr√© Blanc d'Indication --- */
        #validation-indicator {
            width: 20px;
            height: 20px;
            background-color: white;
            border: 2px solid white;
            opacity: 0;
            transition: opacity 0.3s;
        }
        .indicator-ready { opacity: 1; background-color: var(--couleur-correct); }
        .indicator-error { opacity: 1; background-color: var(--couleur-absent); }
        .message-error { color: var(--couleur-absent); }
        .message-success { color: var(--couleur-correct); }

        /* --- Grille de Jeu (Responsive) --- */
        #grille {
            display: grid;
            grid-template-columns: repeat(var(--longueur-mot), minmax(35px, var(--taille-case)));
            grid-template-rows: repeat(var(--max-tentatives), minmax(35px, var(--taille-case)));
            gap: 1px;
            background-color: white;
            border: 1px solid white; 
            max-width: var(--taille-grille-max);
            width: 100%;
            margin-bottom: 20px;
        }
        .case {
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 5vw; /* Taille de police adaptable */
            font-weight: bold;
            color: white;
            background-color: var(--couleur-grille);
            border: none;
            text-transform: uppercase;
        }

        /* --- Clavier AZERTY (Responsive) --- */
        #clavier {
            width: 95%;
            max-width: 500px; /* Align√© avec la grille max */
        }
        .clavier-ligne {
            display: flex;
            justify-content: center;
            flex-wrap: nowrap; /* Les lignes restent sur une seule ligne */
        }
        .clavier-touche {
            display: flex;
            justify-content: center;
            align-items: center;
            flex-grow: 1; /* Distribue l'espace √©galement */
            height: 40px;
            margin: 3px;
            font-size: 3.5vw; /* Taille de police adaptable */
            font-weight: bold;
            border-radius: 4px;
            text-transform: uppercase;
            border: 2px solid var(--couleur-clavier-default);
            background-color: var(--couleur-clavier-default);
            color: var(--couleur-texte);
            cursor: pointer;
            user-select: none;
        }
        .clavier-fonction {
            width: 15%; /* Fonction plus large que les lettres */
            flex-grow: 0;
            font-size: 3vw;
        }

        /* --- Classes de couleur (s'appliquent aux cases et aux touches) --- */
        .lettre-correct { background-color: var(--couleur-correct) !important; border-color: var(--couleur-correct) !important; }
        .lettre-misplaced { background-color: var(--couleur-misplaced) !important; border-color: var(--couleur-misplaced) !important; }
        .lettre-absent { background-color: var(--couleur-absent) !important; border-color: var(--couleur-absent) !important; }
        .lettre-default { background-color: var(--couleur-clavier-default) !important; border-color: var(--couleur-clavier-default) !important; }

        /* Media Query pour les grands √©crans (maintenir une taille maximale) */
        @media (min-width: 600px) {
            :root {
                --taille-case: 45px; /* Taille fixe pour les grands √©crans */
            }
            .case, .clavier-touche {
                font-size: 16px; 
            }
            .case {
                 font-size: 24px;
            }
        }
    </style>
</head>
<body>
    <div id="contenu">
        <header>
            <h1>ü§´ SUTOM </h1>
            <p>Mot myst√®re de 8 lettres. Bonne chance !</p>
        </header>

        <div id="message-area">
            <div id="validation-indicator"></div>
            <div id="notification-text"></div>
        </div>
        
        <div id="grille">
            </div>

        <div id="clavier">
            </div>

    </div>

    <script>
        // --- Configuration et √âtat du Jeu ---
        const MOT_MYSTERE = "QUIETUDE"; // 8 lettres sans accent
        const LONGUEUR_MOT = MOT_MYSTERE.length; // 8
        const PREMIERE_LETTRE = MOT_MYSTERE[0]; // Q
        const MAX_TENTATIVES = 6;
        
        const CLAVIER_LAYOUT = [
            "AZERTYUIOP",
            "QSDFGHJKLM",
            "WXCVBN"
        ];

        let tentatives = [];
        let indexTentative = 0;
        let indexCase = 0; // Commence √† la premi√®re case
        let jeuTermine = false;
        let etatClavier = {}; 

        // --- 3. Fonctions d'Initialisation et d'Affichage ---

        function initJeu() {
            // Initialiser l'√©tat du clavier
            for (let i = 0; i < 26; i++) {
                etatClavier[String.fromCharCode(65 + i)] = 'default';
            }

            // G√©n√©rer la grille HTML
            const grille = document.getElementById('grille');
            grille.style.setProperty('--longueur-mot', LONGUEUR_MOT);
            
            for (let i = 0; i < MAX_TENTATIVES * LONGUEUR_MOT; i++) {
                const caseElement = document.createElement('div');
                caseElement.className = 'case';
                caseElement.id = `case-${i}`;
                grille.appendChild(caseElement);
            }
            
            // G√©n√©rer le clavier HTML et attacher les √©couteurs
            genererClavier();
            
            setMessage(`Tentative ${indexTentative + 1} / ${MAX_TENTATIVES}. Devinez le mot !`, false);
            updateIndicator();
        }

        function genererClavier() {
            const clavierElement = document.getElementById('clavier');
            clavierElement.innerHTML = '';

            CLAVIER_LAYOUT.forEach(ligne => {
                const ligneDiv = document.createElement('div');
                ligneDiv.className = 'clavier-ligne';
                
                ligne.split('').forEach(lettre => {
                    const touche = document.createElement('div');
                    touche.className = `clavier-touche lettre-${etatClavier[lettre]}`;
                    touche.textContent = lettre;
                    touche.id = `touche-${lettre}`;
                    touche.addEventListener('click', () => saisirLettre(lettre));
                    ligneDiv.appendChild(touche);
                });
                clavierElement.appendChild(ligneDiv);
            });
            
            // Ajouter les touches de fonction
            const ligneFonction = document.createElement('div');
            ligneFonction.className = 'clavier-ligne';

            // Touche Entr√©e
            const toucheEntree = document.createElement('div');
            toucheEntree.className = 'clavier-touche clavier-fonction';
            toucheEntree.textContent = 'ENTR√âE';
            toucheEntree.addEventListener('click', evaluerMot); 
            ligneFonction.appendChild(toucheEntree);

            // Touche Supprimer
            const toucheSuppr = document.createElement('div');
            toucheSuppr.className = 'clavier-touche clavier-fonction';
            toucheSuppr.textContent = 'SUPPR';
            toucheSuppr.addEventListener('click', effacerLettre);
            ligneFonction.appendChild(toucheSuppr);
            
            clavierElement.appendChild(ligneFonction);
        }
        
        function updateClavier() {
            CLAVIER_LAYOUT.forEach(ligne => {
                ligne.split('').forEach(lettre => {
                    const touche = document.getElementById(`touche-${lettre}`);
                    if (touche) {
                        touche.classList.remove('lettre-correct', 'lettre-misplaced', 'lettre-absent', 'lettre-default');
                        touche.classList.add(`lettre-${etatClavier[lettre]}`);
                    }
                });
            });
        }

        function setMessage(texte, isError) {
            const msgText = document.getElementById('notification-text');
            msgText.textContent = texte;
            msgText.className = isError ? 'message-error' : 'message-success';
        }
        
        function updateIndicator(isError = false, isReady = false) {
            const indicator = document.getElementById('validation-indicator');
            indicator.classList.remove('indicator-ready', 'indicator-error');
            indicator.style.opacity = '0';
            
            if (isReady) {
                indicator.classList.add('indicator-ready');
                indicator.style.opacity = '1';
            } else if (isError) {
                indicator.classList.add('indicator-error');
                indicator.style.opacity = '1';
            }
        }

        // --- 4. Logique de Saisie et d'Effacement ---

        function getCase(tentative, index) {
            return document.getElementById(`case-${tentative * LONGUEUR_MOT + index}`);
        }

        function saisirLettre(lettre) {
            if (jeuTermine || indexCase >= LONGUEUR_MOT) return;
            
            const caseElement = getCase(indexTentative, indexCase);
            caseElement.textContent = lettre;
            indexCase++;
            
            // Validation automatique si le mot est complet
            if (indexCase === LONGUEUR_MOT) {
                updateIndicator(false, true); // Carr√© vert/pr√™t
                evaluerMot();
            } else {
                updateIndicator(false, false);
            }
        }

        function effacerLettre() {
            if (jeuTermine || indexCase <= 0) return;
            
            indexCase--;
            const caseElement = getCase(indexTentative, indexCase);
            caseElement.textContent = '';
            
            updateIndicator(false, false);
        }
        
        // --- 5. Logique d'√âvaluation SUTOM ---
        
        function evaluerMot() {
            if (jeuTermine) return;
            
            let proposition = '';
            const debutLigne = indexTentative * LONGUEUR_MOT;
            for (let i = 0; i < LONGUEUR_MOT; i++) {
                proposition += document.getElementById(`case-${debutLigne + i}`).textContent;
            }

            // V√©rification de la compl√©tude
            if (proposition.length !== LONGUEUR_MOT || proposition.includes(' ')) {
                setMessage("Le mot n'est pas complet !", true);
                updateIndicator(true, false);
                return;
            }

            // --- Logique SUTOM ---
            const evaluation = evaluerPropositionSutom(proposition);
            
            // Mise √† jour de la grille et du clavier
            appliquerEvaluation(evaluation, debutLigne);
            updateClavier();

            // Mise √† jour de l'√©tat du jeu
            indexTentative++;
            indexCase = 0; // R√©initialise l'index au d√©but de la nouvelle ligne
            tentatives.push(proposition);

            if (proposition === MOT_MYSTERE) {
                finirJeu(true);
            } else if (indexTentative >= MAX_TENTATIVES) {
                finirJeu(false);
            } else {
                setMessage(`Tentative ${indexTentative + 1} / ${MAX_TENTATIVES}. Continuez !`, false);
            }
            updateIndicator(false, false);
        }

        function evaluerPropositionSutom(proposition) {
            const motMystereList = MOT_MYSTERE.split('');
            const propositionList = proposition.split('');
            const resultat = Array(LONGUEUR_MOT).fill(null);
            
            const comptageMystere = {};
            for (const lettre of MOT_MYSTERE) {
                comptageMystere[lettre] = (comptageMystere[lettre] || 0) + 1;
            }

            // Phase 1 : Vert
            for (let i = 0; i < LONGUEUR_MOT; i++) {
                if (propositionList[i] === motMystereList[i]) {
                    resultat[i] = 'correct';
                    comptageMystere[propositionList[i]]--;
                    etatClavier[propositionList[i]] = 'correct';
                }
            }

            // Phase 2 : Orange et Rouge
            for (let i = 0; i < LONGUEUR_MOT; i++) {
                if (resultat[i] === null) {
                    const lettre = propositionList[i];
                    if (comptageMystere[lettre] > 0) {
                        resultat[i] = 'misplaced'; // Orange
                        comptageMystere[lettre]--;
                        if (etatClavier[lettre] !== 'correct') {
                            etatClavier[lettre] = 'misplaced';
                        }
                    } else {
                        resultat[i] = 'absent'; // Rouge
                        if (etatClavier[lettre] !== 'correct' && etatClavier[lettre] !== 'misplaced') {
                            etatClavier[lettre] = 'absent';
                        }
                    }
                }
            }
            return resultat;
        }

        function appliquerEvaluation(evaluation, debutLigne) {
            for (let i = 0; i < LONGUEUR_MOT; i++) {
                const caseElement = document.getElementById(`case-${debutLigne + i}`);
                caseElement.classList.add(`lettre-${evaluation[i]}`);
            }
        }

        function finirJeu(victoire) {
            jeuTermine = true;
            if (victoire) {
                setMessage(`ü•≥ Victoire ! Vous avez trouv√© '${MOT_MYSTERE}' en ${tentatives.length} tentatives !`, false);
            } else {
                setMessage(`üò≠ D√©faite ! '.`, true);
            }
            
            const restartBtn = document.createElement('button');
            restartBtn.textContent = 'Recommencer';
            restartBtn.style.padding = '5px 10px';
            restartBtn.style.marginLeft = '10px';
            restartBtn.style.cursor = 'pointer';
            restartBtn.style.backgroundColor = 'var(--couleur-clavier-default)';
            restartBtn.style.color = 'white';
            restartBtn.style.border = 'none';

            restartBtn.onclick = () => window.location.reload();
            document.getElementById('message-area').appendChild(restartBtn);
        }

        // --- D√©marrage du Jeu (Ex√©cut√© au chargement) ---
        window.onload = initJeu;
        
        // G√©rer les frappes au clavier physique (pour les ordinateurs)
        document.addEventListener('keyup', (e) => {
            if (jeuTermine) return;

            const touche = e.key.toUpperCase();
            
            if (touche.length === 1 && /[A-Z]/.test(touche)) {
                // Saisie de lettres
                saisirLettre(touche);
            } else if (touche === 'BACKSPACE' || touche === 'DELETE') {
                // Suppression
                effacerLettre();
            } else if (touche === 'ENTER' && indexCase === LONGUEUR_MOT) {
                // √âvaluation (manuelle, d√©clench√©e si la saisie auto a √©chou√©)
                evaluerMot();
            }
        });
    </script>
</body>
</html>

