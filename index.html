<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SUTOM - QUIETUDE</title>
    <style>
        /* CSS bas√© sur votre design (Bleu fonc√©/Bleu, Rouge/Orange) */
        :root {
            --couleur-fond: #212121; /* Fond sombre */
            --couleur-grille: #1a73e8; /* Bleu de la grille */
            --couleur-texte: #f0f0f0;
            --couleur-correct: #6aaa64; /* Vert */
            --couleur-misplaced: #ff9900; /* Orange */
            --couleur-absent: #cc0000; /* Rouge */
            --couleur-clavier-default: #444; /* Gris sombre clavier */
            --taille-case: 45px;
            --longueur-mot: 8; /* QUIETUDE a 8 lettres */
            --max-tentatives: 6;
        }

        body {
            font-family: Arial, sans-serif;
            background-color: var(--couleur-fond);
            color: var(--couleur-texte);
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }

        /* --- En-t√™te et Messages --- */
        header {
            text-align: center;
            margin-bottom: 20px;
        }
        #message-area {
            min-height: 20px;
            margin-bottom: 10px;
            font-weight: bold;
            display: flex; /* Permet d'aligner le carr√© blanc */
            align-items: center;
            justify-content: center;
            gap: 15px;
        }
        
        /* --- Le Carr√© Blanc d'Indication --- */
        #validation-indicator {
            width: 20px;
            height: 20px;
            background-color: white; /* Carr√© blanc */
            border: 2px solid white;
            opacity: 0; /* Cach√© par d√©faut */
            transition: opacity 0.3s;
        }
        .indicator-ready {
            opacity: 1;
            background-color: var(--couleur-correct);
        }
        .indicator-error {
            opacity: 1;
            background-color: var(--couleur-absent);
        }
        .message-error { color: var(--couleur-absent); }
        .message-success { color: var(--couleur-correct); }

        /* --- Grille de Jeu --- */
        #grille {
            display: grid;
            grid-template-columns: repeat(var(--longueur-mot), var(--taille-case));
            grid-template-rows: repeat(var(--max-tentatives), var(--taille-case));
            gap: 1px;
            background-color: white;
            border: 1px solid white; 
            margin-bottom: 20px;
        }
        .case {
            display: flex;
            justify-content: center;
            align-items: center;
            width: var(--taille-case);
            height: var(--taille-case);
            font-size: 24px;
            font-weight: bold;
            color: white;
            background-color: var(--couleur-grille);
            border: none;
            text-transform: uppercase;
        }

        /* --- Clavier AZERTY --- */
        #clavier {
            margin-top: 20px;
        }
        .clavier-ligne {
            display: flex;
            justify-content: center;
        }
        .clavier-touche {
            display: flex;
            justify-content: center;
            align-items: center;
            width: 40px; 
            height: 45px;
            margin: 3px;
            font-size: 16px;
            font-weight: bold;
            border-radius: 4px;
            text-transform: uppercase;
            border: 2px solid var(--couleur-clavier-default);
            background-color: var(--couleur-clavier-default);
            color: var(--couleur-texte);
            cursor: pointer;
            user-select: none;
        }
        .clavier-fonction {
            width: 60px;
            font-size: 14px;
        }

        /* --- Classes de couleur (s'appliquent aux cases et aux touches) --- */
        .lettre-correct { background-color: var(--couleur-correct) !important; border-color: var(--couleur-correct) !important; }
        .lettre-misplaced { background-color: var(--couleur-misplaced) !important; border-color: var(--couleur-misplaced) !important; }
        .lettre-absent { background-color: var(--couleur-absent) !important; border-color: var(--couleur-absent) !important; }
        .lettre-default { background-color: var(--couleur-clavier-default) !important; border-color: var(--couleur-clavier-default) !important; }
    </style>
</head>
<body>
    <div id="contenu">
        <header>
            <h1>ü§´ SUTOM - QUIETUDE</h1>
            <p>Silence, Calme, S√©r√©nit√© (8 lettres, commence par Q)</p>
        </header>

        <div id="message-area">
            <div id="validation-indicator"></div>
            <div id="notification-text"></div>
        </div>
        
        <div id="grille">
            </div>

        <div id="clavier">
            </div>

    </div>

    <script>
        // --- Configuration et √âtat du Jeu ---
        const MOT_MYSTERE = "QUIETUDE"; // 8 lettres sans accent
        const LONGUEUR_MOT = MOT_MYSTERE.length; // 8
        const PREMIERE_LETTRE = MOT_MYSTERE[0]; // Q
        const MAX_TENTATIVES = 6;
        
        const CLAVIER_LAYOUT = [
            "AZERTYUIOP",
            "QSDFGHJKLM",
            "WXCVBN"
        ];

        let tentatives = [];
        let indexTentative = 0;
        let indexCase = 0;
        let jeuTermine = false;
        let etatClavier = {}; 

        // --- 3. Fonctions d'Initialisation et d'Affichage ---

        function initJeu() {
            // Initialiser l'√©tat du clavier
            for (let i = 0; i < 26; i++) {
                etatClavier[String.fromCharCode(65 + i)] = 'default';
            }

            // G√©n√©rer la grille HTML
            const grille = document.getElementById('grille');
            grille.style.setProperty('--longueur-mot', LONGUEUR_MOT);
            
            for (let i = 0; i < MAX_TENTATIVES * LONGUEUR_MOT; i++) {
                const caseElement = document.createElement('div');
                caseElement.className = 'case';
                caseElement.id = `case-${i}`;
                grille.appendChild(caseElement);
            }
            
            // R√©v√©ler la premi√®re lettre
            const premiereCase = document.getElementById('case-0');
            premiereCase.textContent = PREMIERE_LETTRE;
            premiereCase.classList.add('lettre-correct');
            indexCase = 1; // Commence √† la deuxi√®me case
            
            // G√©n√©rer le clavier HTML et attacher les √©couteurs
            genererClavier();
            
            setMessage(`Tentative ${indexTentative + 1} : Saisissez votre mot.`, false);
            updateIndicator();
        }

        function genererClavier() {
            const clavierElement = document.getElementById('clavier');
            clavierElement.innerHTML = '';

            CLAVIER_LAYOUT.forEach(ligne => {
                const ligneDiv = document.createElement('div');
                ligneDiv.className = 'clavier-ligne';
                
                ligne.split('').forEach(lettre => {
                    const touche = document.createElement('div');
                    touche.className = `clavier-touche lettre-${etatClavier[lettre]}`;
                    touche.textContent = lettre;
                    touche.id = `touche-${lettre}`;
                    touche.addEventListener('click', () => saisirLettre(lettre));
                    ligneDiv.appendChild(touche);
                });
                clavierElement.appendChild(ligneDiv);
            });
            
            // Ajouter les touches de fonction
            const ligneFonction = document.createElement('div');
            ligneFonction.className = 'clavier-ligne';

            // Touche Entr√©e
            const toucheEntree = document.createElement('div');
            toucheEntree.className = 'clavier-touche clavier-fonction';
            toucheEntree.textContent = 'ENTR√âE';
            // L'entr√©e est d√©clench√©e automatiquement (evaluerMot), mais on garde la touche pour le clic manuel
            toucheEntree.addEventListener('click', evaluerMot); 
            ligneFonction.appendChild(toucheEntree);

            // Touche Supprimer
            const toucheSuppr = document.createElement('div');
            toucheSuppr.className = 'clavier-touche clavier-fonction';
            toucheSuppr.textContent = 'SUPPR';
            toucheSuppr.addEventListener('click', effacerLettre);
            ligneFonction.appendChild(toucheSuppr);
            
            clavierElement.appendChild(ligneFonction);
        }
        
        function updateClavier() {
            CLAVIER_LAYOUT.forEach(ligne => {
                ligne.split('').forEach(lettre => {
                    const touche = document.getElementById(`touche-${lettre}`);
                    if (touche) {
                        touche.classList.remove('lettre-correct', 'lettre-misplaced', 'lettre-absent', 'lettre-default');
                        touche.classList.add(`lettre-${etatClavier[lettre]}`);
                    }
                });
            });
        }

        function setMessage(texte, isError) {
            const msgText = document.getElementById('notification-text');
            msgText.textContent = texte;
            msgText.className = isError ? 'message-error' : 'message-success';
        }
        
        function updateIndicator(isError = false, isReady = false) {
            const indicator = document.getElementById('validation-indicator');
            indicator.classList.remove('indicator-ready', 'indicator-error');
            indicator.style.opacity = '0';
            
            if (isReady) {
                indicator.classList.add('indicator-ready');
                indicator.style.opacity = '1';
            } else if (isError) {
                indicator.classList.add('indicator-error');
                indicator.style.opacity = '1';
            }
        }

        // --- 4. Logique de Saisie et d'Effacement ---

        function getCase(tentative, index) {
            return document.getElementById(`case-${tentative * LONGUEUR_MOT + index}`);
        }

        function saisirLettre(lettre) {
            if (jeuTermine || indexCase >= LONGUEUR_MOT) return;
            
            // Emp√™cher l'√©crasement de la premi√®re lettre
            if (indexCase === 0) indexCase = 1;
            
            if (indexCase < LONGUEUR_MOT) {
                const caseElement = getCase(indexTentative, indexCase);
                caseElement.textContent = lettre;
                indexCase++;
            }
            // Validation automatique si le mot est complet
            if (indexCase === LONGUEUR_MOT) {
                updateIndicator(false, true); // Carr√© vert/pr√™t
                evaluerMot();
            } else {
                updateIndicator(false, false);
            }
        }

        function effacerLettre() {
            if (jeuTermine || indexCase <= 1) return; // Ne pas effacer la premi√®re lettre
            
            indexCase--;
            const caseElement = getCase(indexTentative, indexCase);
            caseElement.textContent = '';
            
            updateIndicator(false, false);
        }
        
        // --- 5. Logique d'√âvaluation SUTOM ---
        
        function evaluerMot() {
            if (jeuTermine) return;
            
            let proposition = '';
            const debutLigne = indexTentative * LONGUEUR_MOT;
            for (let i = 0; i < LONGUEUR_MOT; i++) {
                proposition += document.getElementById(`case-${debutLigne + i}`).textContent;
            }

            // V√©rification de la compl√©tude
            if (proposition.length !== LONGUEUR_MOT) {
                setMessage("Le mot n'est pas complet !", true);
                updateIndicator(true, false); // Carr√© rouge/erreur
                return;
            }

            // √âvaluation compl√®te
            const evaluation = evaluerPropositionSutom(proposition);
            
            // Mise √† jour de la grille et du clavier
            appliquerEvaluation(evaluation, debutLigne);
            updateClavier();

            // Mise √† jour de l'√©tat du jeu
            indexTentative++;
            indexCase = 1; 
            tentatives.push(proposition);

            if (proposition === MOT_MYSTERE) {
                finirJeu(true);
            } else if (indexTentative >= MAX_TENTATIVES) {
                finirJeu(false);
            } else {
                setMessage(`Tentative ${indexTentative + 1} / ${MAX_TENTATIVES}. Continuez !`, false);
                // Pr√©parer la premi√®re lettre de la prochaine ligne
                const premiereCaseSuivante = getCase(indexTentative, 0);
                if (premiereCaseSuivante) {
                    premiereCaseSuivante.textContent = PREMIERE_LETTRE;
                    premiereCaseSuivante.classList.add('lettre-correct');
                }
            }
            updateIndicator(false, false); // Cacher l'indicateur apr√®s l'√©valuation
        }

        function evaluerPropositionSutom(proposition) {
            const motMystereList = MOT_MYSTERE.split('');
            const propositionList = proposition.split('');
            const resultat = Array(LONGUEUR_MOT).fill(null);
            
            const comptageMystere = {};
            for (const lettre of MOT_MYSTERE) {
                comptageMystere[lettre] = (comptageMystere[lettre] || 0) + 1;
            }

            // Phase 1 : Vert
            for (let i = 0; i < LONGUEUR_MOT; i++) {
                if (propositionList[i] === motMystereList[i]) {
                    resultat[i] = 'correct';
                    comptageMystere[propositionList[i]]--;
                    etatClavier[propositionList[i]] = 'correct';
                }
            }

            // Phase 2 : Orange et Rouge
            for (let i = 0; i < LONGUEUR_MOT; i++) {
                if (resultat[i] === null) {
                    const lettre = propositionList[i];
                    if (comptageMystere[lettre] > 0) {
                        resultat[i] = 'misplaced'; // Orange
                        comptageMystere[lettre]--;
                        if (etatClavier[lettre] !== 'correct') {
                            etatClavier[lettre] = 'misplaced';
                        }
                    } else {
                        resultat[i] = 'absent'; // Rouge
                        if (etatClavier[lettre] !== 'correct' && etatClavier[lettre] !== 'misplaced') {
                            etatClavier[lettre] = 'absent';
                        }
                    }
                }
            }
            return resultat;
        }

        function appliquerEvaluation(evaluation, debutLigne) {
            for (let i = 0; i < LONGUEUR_MOT; i++) {
                const caseElement = document.getElementById(`case-${debutLigne + i}`);
                caseElement.classList.add(`lettre-${evaluation[i]}`);
            }
        }

        function finirJeu(victoire) {
            jeuTermine = true;
            if (victoire) {
                setMessage(`ü•≥ Victoire ! Vous avez trouv√© '${MOT_MYSTERE}' en ${tentatives.length} tentatives !`, false);
            } else {
                setMessage(`üò≠ D√©faite ! Le mot √©tait '${MOT_MYSTERE}'.`, true);
            }
            
            const restartBtn = document.createElement('button');
            restartBtn.textContent = 'Recommencer';
            restartBtn.onclick = () => window.location.reload();
            document.getElementById('message-area').appendChild(restartBtn);
        }

        // --- D√©marrage du Jeu (Ex√©cut√© au chargement) ---
        window.onload = initJeu;
        
        // G√©rer les frappes au clavier physique (pour les ordinateurs)
        document.addEventListener('keyup', (e) => {
            if (jeuTermine) return;

            const touche = e.key.toUpperCase();
            
            if (touche.length === 1 && /[A-Z]/.test(touche)) {
                // Saisie de lettres
                saisirLettre(touche);
            } else if (touche === 'BACKSPACE' || touche === 'DELETE') {
                // Suppression
                effacerLettre();
            } else if (touche === 'ENTER' && indexCase === LONGUEUR_MOT) {
                // Validation manuelle (redondante mais utile)
                evaluerMot();
            }
        });
    </script>
</body>
</html>
